ToastyCut - это плагин к CorelDraw для плоттерной резки.
<p><img src=0.svg>
<h1>Особенности</h1>
<ul>
<li>Наиболее дорогостоящей операцией при резке является промотка материала, т.к. при промотке происходит проскальзывание материала, что в свою очередь приводит к снижению точности. ToastyCut при построении траектории стремится уменьшить расстояние промотки.
<li>Поддерживаются все модели плоттеров, поддерживаемые в ArtCut6. Тажке добавлена поддержка плоттеров SkyCut (вырезание по меткам возможно только через файл).
<li>Вывод данных осуществляется в COM-порт, файл или по протоколу TCP/IP.
<li>Настройки программы сохраняются в exe-файл автоматически при выходе из программы.
</ul>
<h1>Системные требования</h1>
<table>
<table><tr><td>Операционная система:<td>Windows XP или выше
<tr><td>Программное обеспечение:<td>32-битный Corel Draw версии 13 или выше
<tr><td>Видеокарта:<td>с поддежкой GL_ARB_VERTEX_BUFFER_OBJECT
<tr><td>Процессор:<td>с поддежкой SSE3
</table>
<h1>Установка</h1>
<ol>
<li>Запустите ToastyCut.exe, на запрос об установке нужно ответить утвердительно.
<p><img src=1.png><p>
<li>После завершения установки появится соответствующее сообщение. Теперь нужно перезапустить Corel Draw
<p><img src=2.png><p>
<li>Переместите панель ToastyCut в верхнюю часть окна Corel Draw.
<p><img src=1.gif><p>
Если панель не появилась, её можно задействовать в меню "Инструменты->Параметры->Рабочее пространство->Настройка->Панели команд".</ol>
<h1>Интерфейс</h1>
<img src=3.png><p>
<ol>
<li>Список выбора модели плоттера
<li>Команда инициализации плоттера
<li>Команда перемещения с поднятым ножом
<li>Команда перемещения с опущеным ножом
<li>Разделитель координат
<li>Разделитель команд
<li>Команда окончания файла
<li>Количество единиц в системе координат плоттера на дюйм по оси x
<li>Количество единиц в системе координат плоттера на дюйм по оси y
<li>Направление оси x
<li>Поменять оси x и y местами
<li>Расстояние в миллиметрах от кончика ножа до его центральной оси
<p><img src=1.svg><p>
Если нет возможности провести точные измерения этот параметр можно подобрать акспериментально
<li>Длина сегмента дуги разворота ножа. Оптимальное значение 0.1мм, обычно этот параметр не требуется изменять. ArtCut, к слову, выполняет разворот ножа не по дуге, а по прямой.
<p><img src=2.svg><p>
<li>Выполнить разворот ножа перед началом резки
<li>Отобразить узловые точки
<li>Список выбора порта для вывода, это может быть COM-порт, файл или IP-адрес
<li>Параметры порта
<li>Кнопка запуска резки
<li>Контур для резки
<li>Траектория перемещения с поднятым ножом
</ol>
<h1>Подключение станка по сети</h1>
ToastyCut позволяет выполнять отправку команд через TCP/IP (выбирается в выпадающем списке "порт"). Для работы по сети подключите плоттер через маршрутизатор hlk-rm04 или что-нибудь подобное<p><img src=1.jpg>
<h1>Сообщения об ошибках</h1>
<table rules=all cellspasing=0 border=1 bordercolor=0>
<tr><th>Сообщение об ошибке<th>Причина<th>Как исправить
<tr><td>Интерфейс Corel Draw не зарегистрирован в системе<td>В реестре отсутсвует информация о Corel Draw<td>Переустановить Corel Draw
<tr><td>Нет доступа к Corel Draw<td>Класс {B058000B-9AA4-44FD-9547-4F91EB757AC4} не зарегистрирован в системе. Возможно установлена не подходящая версия Corel Draw<td>Установить 32-битный Corel Draw версии 13 или выше.
<tr><td>Не удалось скопировать файлы в каталог Corel Draw<td>Недостаточно прав на копирование файлов в каталог Corel Draw либо недостаточно свободного места на диске.<td>Запустить программу с правами администратора, убедиться что на диске достаточно свободного места.
<tr><td>Нет открытых документов в Corel Draw<td>Метод <a href=https://community.coreldraw.com/sdk/api/draw/17.4/p/application.activedocument>Get_ActiveDocument</a> интерфейса <a href=https://community.coreldraw.com/sdk/api/draw/17.4/i/ivgapplication>IVGApplication</a> вернул 0. Такое может произойти если текущий документ не сохранён. Если запущено 2 и более экземпляров CorelDraw, ToastyCut работает с превым экземпляром.<td>Выполнить сохранение активного документа в файл.
<tr><td>Ничего не выбрано<td>В активном документе нет выделенных объектов. Если запущено 2 и более экземпляров CorelDraw активным документом считается документ, открытый в первом экземпляре.<td>Выделить объекты для резки
<tr><td>Не удалось объединить кривые<td>К одному из выбраных объектов применён эффект (меню "эффекты")<td>Удалить эффекты через диспетчер объектов ("окно->окна настройки->объекты" либо "окно->окна настройки->диспетчер объектов")
<tr><td>Не достаточно оперативной памяти<td>Для импорта объектов в ToastyCut не хватает оперативной памяти<td>Закрыть не используемые приложения и документы CorelDraw, выполнить автоматическое сокращение числа узлов в выбранных кривых. Если памяти по прежнему не достаточно выбрать меньшее количество объектов для резки.
<tr><td>Видеокарта не поддерживает GL_ARB_VERTEX_BUFFER_OBJECT<td>Не удалось получить указатель на одну из функций: glGenBuffersARB, glBindBufferARB, glBufferDataARB. Возможно видеокарта либо драйвер не поддерживают <a href=https://registry.khronos.org/OpenGL/extensions/ARB/ARB_vertex_buffer_object.txt>расширение GL_ARB_VERTEX_BUFFER_OBJECT</a>.<td>Обновить драйвер видеокарты либо обновить видеокарту. Может потребоваться сменить операционную систему, например видеочип Intel 945GM <a href=https://opengl.gpuinfo.org/displayreport.php?id=605>поддерживает данное расширение</a>, но драйвер существует только для 32-битной версии Windows.
<tr><td>Процессор не поддерживает SSE3<td><a href=https://ru.wikipedia.org/wiki/SSE3>Набор инструкций SSE3</a> не поддерживается процессором<td>Обновить процессор
</table>
<h1>Компиляция</h1>
<ol>
<li>Для сборки понадобятся <a href=http://flatassembler.net/download.php>FASM</a> и <a href=https://tukaani.org/xz/xz-5.2.9-windows.7z>XZ Utils</a>.
<li>В файле make.bat нужно изменить значения переменных include, xz и fasm, чтобы они соответствовали реальным путям на вашем компьютере.
<li>Теперь можно запускать make.bat
</ol>
